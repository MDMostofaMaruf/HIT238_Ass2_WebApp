<html>
<head>
    <title>
    Appoinments
    </title>
    <link rel="stylesheet" type ="text/css" href="css/BookAppoinment.css">
    </head>
<body style="background-image:url(image/form.jpeg)">
    
    <div class= "body-container">

          <div class ="nav-bar">
        <div class="Left-nav-bar">
        <a href="home.html">Home</a>
       <a href="MyProfile.html">My profile</a>
            <a href="MyAppoinments.html">My appoinments</a>
       <a href="about.html">About us</a>
        </div>
        
        <div class ="Right-nav-bar">
        <a href="index.html">Log in</a>
       <a href="SignUp.html"> Sign up</a>
            <a> <input type="text" placeholder="Search..">    </a>
        </div>
            
            
    </div>
        
                <div class ="head-content">
            <h1> Book your appoinments</h1>
        
        </div>
    <div class="Form">
  <div class="inputForm">
      <div class="inputRow">
      <label for="valueInput">Doctor's Name</label>
      <input type="text" name="key" id="valueInput" />
    </div>
    <div class="inputRow">
      <label for="keyInput">Email</label>
      <input type="email" name="key" id="keyInput" />
    </div>
    <div class="inputRow">
      <label for="valueInput1">First name</label>
      <input type="text" name="value" id="valueInput1" />
    </div>
       <div class="inputRow">
      <label for="valueInput2">Last name</label>
      <input type="text" name="value" id="valueInput2" />
    </div>
      <div class="inputRow">
      <label for="valueInput3">Date</label>
      <input type="date" name="value" id="valueInput3" />
    </div>
       <div class="inputRow">
      <label for="valueInput4">Time</label>
      <input type="time" name="value" id="valueInput4" />
    </div>
      
      <div class = "inputRow">
    <button id="saveBtn">Confirm</button>
          <button id="loadBtn">Load Data</button>
    
  </div>
        </div>
  <div id="container">
      <h2>Task List</h2>
      <ul id="task_wrapper"></ul>
    </div>
</div>
        
        
       
    </div>
    </body>
    
    
    
    
    
    
    
    <script>
    
 (function() {
  'use strict';
  var lastId = 0;
  var taskWrapper = document.getElementById("task_wrapper");
  var btnSave = document.getElementById("saveBtn");
  var removeIcon;
  var updateIcon;
  var taskList;

  // Initialize taskList 
  // Add event to save button
  // Render the list

  function init() {

    if (!!(window.localStorage.getItem('taskList'))) {
      taskList = JSON.parse(window.localStorage.getItem('taskList'));
    } else {
      taskList = [];
    }
    btnSave.addEventListener('click', saveTask);
    showList();
  }

  //End Init

  //CRUD task

  function showList() {

    if (!!taskList.length) {
      getLastTaskId();
      for (var item in taskList) {
        var task = taskList[item];
        addTaskToList(task);
      }
      syncEvents();
    }
    
  }

  function saveTask(event) {

    var task = {
      taskId: lastId,
      taskDes: document.getElementById("keyInput").value,
      taskState: document.getElementById("valueInput").value,
       
   
    };
    taskList.push(task);
    syncTask();
    addTaskToList(task);
    syncEvents();
    lastId++;
  }

  function addTaskToList(task) {

    var removeIcon = document.createElement('span');
    var element = document.createElement('li');
    var updateIcon = document.createElement('span');

    removeIcon.innerHTML = "X";
    removeIcon.className = "remove_item clickeable";
    removeIcon.setAttribute("title", "Remove");

    updateIcon.innerHTML = "U";
    updateIcon.className = "update_icon clickeable";
    updateIcon.setAttribute("title", "Update");


    element.appendChild(removeIcon);
    element.appendChild(updateIcon);
    element.setAttribute("id", task.taskId);
    element.innerHTML += task.taskDes;
      taskWrapper.appendChild(element);
    
  }

  function updateTask(event) {

    var taskTag = event.currentTarget.parentNode;
    var taskId = taskTag.id;
    var taskToUpdate = findTask(taskId).task;
    var pos = findTask(taskId).pos;
    if (!!taskToUpdate) {
      var des = prompt("Task Description", taskToUpdate.taskDes);
      var state = prompt("Task State", taskToUpdate.taskState);
      taskToUpdate.taskDes = des;
      taskToUpdate.taskState = state;
      taskList[pos] = taskToUpdate;
      taskTag.lastChild.textContent = taskToUpdate.taskDes;
      syncTask();
    }
  }

  function removeTask(event) {

    var taskToRemove = event.currentTarget.parentNode;
    var taskId = taskToRemove.id;
    taskWrapper.removeChild(taskToRemove);
    taskList.forEach(function(value, i) {
      if (value.taskId == taskId) {
        taskList.splice(i, 1);
      }
    })

    syncTask();
  }

  // End CRUD


  //Common

  function syncTask() {

    window.localStorage.setItem('taskList', JSON.stringify(taskList));
    taskList = JSON.parse(window.localStorage.getItem('taskList'));
  }

  function getLastTaskId() {
    var lastTask = taskList[taskList.length - 1];
    lastId = lastTask.taskId + 1;
  }

  function syncEvents() {

    updateIcon = document.getElementsByClassName("update_icon");
    removeIcon = document.getElementsByClassName("remove_item");
    if (!!removeIcon.length) {
      for (var i = 0; i < removeIcon.length; i++) {
        removeIcon[i].addEventListener('click', removeTask);
      }
    }
    if (!!updateIcon.length) {
      for (var j = 0; j < updateIcon.length; j++) {
        updateIcon[j].addEventListener('click', updateTask);
      }
    }
  }

  function findTask(id) {

    var response = {
      task: '',
      pos: 0
    };
    taskList.forEach(function(value, i) {
      if (value.taskId == id) {
        response.task = value;
        response.pos = i;
      }
    });

    return response;
  }

  //End Common


  init();


})();

  // Write code here


    
    </script>
    </html>
        